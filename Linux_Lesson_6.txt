Задание 1.1 найдите информацию о том, как в Ubuntu открыть порт 80,443. Укажите как.

Команды ufw для открытия порта у меня без ошибок выполнились, но порты не открылись, поэтому пришлось искать решение в интернете.

Чтобы открыть порт я использовала информацию с сайта
https://losst.ru/kak-otkryt-port-ubuntu 

sudo iptables -A INPUT -i lo -j ACCEPT
sudo iptables -A OUTPUT -o lo -j ACCEPT
sudo iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
sudo iptables -A INPUT -p tcp --dport 80 -j ACCEPT
sudo iptables -A INPUT -p tcp --dport 443 -j ACCEPT
sudo iptables -P INPUT DROP
sudo iptables -nvL

Установим демон, чтобы сохранял конфигурацию
sudo apt-get install iptables-persistent 



Задание 1.2 Установить nginx, сконфигурировать свой виртуальный хост, используя порт 80, так, чтобы:
	на запрос клиента с указанным и непустым хидером 'User'. отправлять код 200 с текстом "Hi $user!", где $user - это значение хидера 'User'.
	иначе отправлять код 404 с текстом "Page not found".


Конфигурация в /etc/nginx/conf.d/ubuntu.conf 
(см. файл конфигурации)

anastasia@anastasia-VirtualBox:~$ curl localhost -H "Host: ubuntu" -H "user:Ana"
Hi, Ana ! 




Задание 2.1 найти информацию о том, что такое самоподписанные сертификаты и сгенерировать такой для своего вэб сервера. Написать своими словами, что это такое и как сгенерить.

Самоподписанный сертификат заверяет сам его владелец, а не доверительные центры сертификации.Такой сертификат обычно используют для тестирования сайтов. Он позволяет шифровать данные при взаимодействии клиент-сервер, но не гарантирует подлинность сервера
На сайте https://www.8host.com/blog/sozdanie-samopodpisannogo-ssl-sertifikata-dlya-nginx-v-ubuntu-16-04/ нашла как в одну строчку создать сертификат:

sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/nginx-selfsigned.key -out /etc/ssl/certs/nginx-selfsigned.crt

Главные опции: 
days 365  срок действия сертификата, в нашем случае 365 дней
keyout куда помещаем сгенерированный ключ
out куда помещаем сертификат
nodes создание сертификата без пароля

[sudo] password for anastasia: 
Can't load /home/anastasia/.rnd into RNG
139911933280704:error:2406F079:random number generator:RAND_load_file:Cannot open file:../crypto/rand/randfile.c:88:Filename=/home/anastasia/.rnd
Generating a RSA private key
....................................................+++++
.............................................................+++++
writing new private key to '/etc/ssl/private/nginx-selfsigned.key'
-----
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----
Country Name (2 letter code) [AU]:DE
State or Province Name (full name) [Some-State]:
Locality Name (eg, city) []:Berlin
Organization Name (eg, company) [Internet Widgits Pty Ltd]:Mizukis Ltd
Organizational Unit Name (eg, section) []:
Common Name (e.g. server FQDN or YOUR name) []:ubuntu
Email Address []:

anastasia@anastasia-VirtualBox:~$ sudo openssl dhparam -out /etc/ssl/certs/dhparam.pem 2048


Создала новый сниппет
sudo vim /etc/nginx/snippets/self-signed.conf

В  котором прописала путь к сертификату и к закрытому ключу:
ssl_certificate /etc/ssl/certs/nginx-selfsigned.crt;
ssl_certificate_key /etc/ssl/private/nginx-selfsigned.key;



Задание 2.2 добавить SSL соединение для дифолтного виртуального хоста nginx, используя порт 443. Прикрепить конфиги nginx.

Создадим резервную копию файла 
sudo cp /etc/nginx/sites-available/default /etc/nginx/sites-available/default.bak

Сделала два блока сервер, см. файл конфигурации
anastasia@anastasia-VirtualBox:~$ sudo vim /etc/nginx/sites-available/default

Так же сделала в первом блоке сервера временный редирект 302.



Задание 2.3 откройте в браузере страницу хоста и посмотрите, как браузер реагирует на самоподписанные сертификаты. Напишите, что видите.

Warning: Potential Security Risk Ahead

Firefox detected a potential security threat and did not continue to localhost. If you visit this site, attackers could try to steal information like your passwords, emails, or credit card details.

Браузер не доверяет самоподписанному сертификату и предупреждает нас о том, что если мы посетим сайт, то могут быть украдены наши личный данные. То есть он не может проверить подлинность хоста.


Задание 2.4 мы говорили о необходимости шифровать симметрично. При этом проблем с получением ассиметричных сертификатов нет. Зачем такая сложная схема для установления SSL соединения? Почему бы не шифровать ассиметрично? Своими словами.


Симметричное шифрование - один пароль для зашифровки и расшифровки, а ассиметричное шифрование - два пароля: публичный (можно отправить всем) и секретный (остаётся на сервере) и зашифрованная одним ключом информация может расшифровать только другим ключом.

Симметричное шифрование очень просто и быстро, нагрузка на железо не большая, такие образом подходит для передачи большого объема информации. При ассиметричном шифровании передача данных будет работать медленнее и оба ключа должны быть известны обеим сторонам.
 
Лучше всего комбинировать эти два вида шифрования.


